<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Equipos - PAL.Store</title>

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <link rel="stylesheet" href="styles/common.css">
    <link rel="stylesheet" href="styles/registrar-equipo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
      /* Estilos base del formulario por pasos (sin cambios) */
      .form-container { overflow: hidden; }
      .form-step { display: none; flex-wrap: wrap; row-gap: 1.25rem; column-gap: 0.9375rem; animation: fadeIn 0.5s ease-in-out; }
      .form-step.active { display: flex; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
      .navigation-btns { width: 100%; display: flex; justify-content: space-between; gap: 0.9375rem; margin-top: 0.625rem; }
      .navigation-btns .btn { flex: 1; padding: 0.75rem; font-size: 1.1rem; font-weight: 700; color: var(--color-blanco); border: none; border-radius: 0.5rem; cursor: pointer; transition: all 0.3s ease; }
      .navigation-btns .prev-btn { background-color: var(--color-texto-secundario-dark); }
      body.light-mode .navigation-btns .prev-btn { background-color: var(--color-texto-secundario-light); }
      .navigation-btns .next-btn { background-color: var(--color-primario); }
      .navigation-btns .btn:hover { transform: translateY(-2px); }
      .navigation-btns .prev-btn.hidden { visibility: hidden; }
      .progress-indicator { display: flex; justify-content: center; gap: 1rem; width: 100%; margin-bottom: 1rem; }
      .progress-step { width: 1rem; height: 1rem; border-radius: 50%; background-color: var(--color-borde-dark); transition: background-color 0.3s ease; }
      body.light-mode .progress-step { background-color: var(--color-borde-light); }
      .progress-step.active { background-color: var(--color-primario); }
      .form-group .terms-text { font-size: 0.8rem; opacity: 0.8; margin-top: 0.3rem; }

      /* ================================================================ */
      /* === INICIO: ESTILOS PARA DIAGNÓSTICO EN COLUMNAS Y RADIOS === */
      /* ================================================================ */

      /* --- 1. Contenedor principal del diagnóstico en dos columnas --- */
      .diagnostic-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem 2rem;
        width: 100%;
      }
      /* Para móviles, una sola columna */
      @media (max-width: 768px) {
        .diagnostic-grid {
          grid-template-columns: 1fr;
        }
      }

      .question-block {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .question-block h5 {
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--color-texto-secundario-dark);
      }
       body.light-mode .question-block h5 {
         color: var(--color-texto-secundario-light);
       }

      /* --- 2. Estilo para los botones de radio personalizados --- */
      .radio-label {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        cursor: pointer;
        padding: 0.25rem;
      }
      .radio-label input[type="radio"] {
        display: none; /* Ocultamos el original */
      }
      .radio-visual {
        width: 20px;
        height: 20px;
        border: 2px solid var(--color-borde-dark);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        flex-shrink: 0;
      }
      body.light-mode .radio-visual {
        border-color: var(--color-borde-light);
      }
      .radio-visual::after { /* Círculo interior */
        content: '';
        width: 10px;
        height: 10px;
        background-color: var(--color-primario);
        border-radius: 50%;
        transform: scale(0);
        transition: transform 0.2s ease;
      }
      /* Estilo cuando está seleccionado */
      .radio-label input:checked + .radio-visual {
        border-color: var(--color-primario);
      }
      .radio-label input:checked + .radio-visual::after {
        transform: scale(1);
      }

      /* --- 3. Estilo para el checklist de accesorios (más compacto) --- */
      .accessories-checklist {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.75rem;
        width: 100%;
      }
       
      /* --- Estilos heredados pero importantes --- */
      .custom-checkbox-label { display: flex; align-items: center; gap: 0.75rem; cursor: pointer; }
      .custom-checkbox-label input[type="checkbox"] { display: none; }
      .custom-checkbox-visual { width: 22px; height: 22px; border: 2px solid var(--color-borde-dark); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; }
      body.light-mode .custom-checkbox-visual { border-color: var(--color-borde-light); }
      .custom-checkbox-visual .fas { font-size: 0.9rem; color: var(--color-blanco); transform: scale(0); transition: transform 0.2s ease; }
      .custom-checkbox-label input:checked + .custom-checkbox-visual { background-color: var(--color-primario); border-color: var(--color-primario); }
      .custom-checkbox-label input:checked + .custom-checkbox-visual .fas { transform: scale(1); }

      .form-group select { padding: 0.75rem; border-radius: 0.5rem; font-size: 1rem; transition: border-color 0.2s, box-shadow 0.2s; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-position: right 0.75rem center; background-repeat: no-repeat; background-size: 1.1em; }
      body.dark-mode .form-group select { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e"); }
      body.light-mode .form-group select { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23475569' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e"); }

    </style>
    </head>
<body class="dark-mode no-sidebar-expand">
  
  <div class="background-container"> <div id="tsparticles"></div> <div class="aurora-overlay"></div> </div>
  <header>
    <div class="logo"> <img src="https://placehold.co/50x50/007BFF/FFFFFF?text=P" alt="PA!.Store" id="logoPreviewHeader"/> </div>
    <nav>
         <a href="escritorio.html" class="nav-button active" title="Escritorio"><i class="fas fa-desktop"></i><span class="nav-text">Escritorio</span></a>
            <a href="registrar-equipo.html" class="nav-button" title="Registrar Equipo"><i class="fas fa-plus-circle"></i><span class="nav-text">Registrar</span></a>
            <a href="registros.html" class="nav-button" title="Ver Registros"><i class="fas fa-history"></i><span class="nav-text">Historial</span></a>
            <a href="inventario.html" class="nav-button" title="Inventario"><i class="fas fa-box-open"></i><span class="nav-text">Inventario</span></a>
            <a href="perfil.html" class="nav-button" title="Mi Perfil"><i class="fas fa-user-circle"></i><span class="nav-text">Mi Perfil</span></a>
        </nav>
    </nav>
    <div class="switch-container" title="Cambiar modo oscuro/claro"> <input type="checkbox" id="darkModeToggle" class="switch-checkbox" checked /> <label for="darkModeToggle" class="switch-slider"></label> </div>
  </header>

  <main class="container">
    <section class="text-content">
      <h1 class="main-title">Oliv.X</h1>
      <h2 class="store-title">Servicio Técnico</h2>
      <p class="subtitle">Registra el ingreso de equipos de forma rápida y segura.</p>
      <p class="tagline">Genera un remito digital y notifica a tus clientes al instante.</p>
    </section>

    <form id="registroEquipos" class="form-container">
      <h3>Registro de Equipo</h3>

      <div class="progress-indicator">
        <div class="progress-step active" data-step="1"></div>
        <div class="progress-step" data-step="2"></div>
        <div class="progress-step" data-step="3"></div>
        <div class="progress-step" data-step="4"></div>
        <div class="progress-step" data-step="5"></div>
      </div>

      <div class="form-group full-width">
        <label for="numeroRemito">N° de Remito</label>
        <input type="text" id="numeroRemito" name="numeroRemito" readonly placeholder="Se genera al registrar" />
      </div>
      
      <div class="form-step active" data-step="1">
        <h4 class="form-section-title">Paso 1: Datos del Cliente</h4>
        <div class="form-group">
          <label for="clienteNombre">Nombre y Apellido (*)</label>
          <input type="text" id="clienteNombre" name="clienteNombre" placeholder="Juan Pérez" required />
        </div>
        
        <div class="form-group">
          <label for="clienteDNI">DNI (Opcional)</label>
          <input type="text" id="clienteDNI" name="clienteDNI" placeholder="Solo números, sin puntos" />
        </div>
        <div class="form-group">
          <label for="clienteTelefono">Teléfono (*)</label>
          <input type="tel" id="clienteTelefono" name="clienteTelefono" placeholder="2664123456" required />
        </div>
        <div class="form-group full-width">
          <label for="clienteEmail">Correo Electrónico (Opcional)</label>
          <input type="email" id="clienteEmail" name="clienteEmail" placeholder="juan.perez@ejemplo.com" />
        </div>
      </div>

      <div class="form-step" data-step="2">
        <h4 class="form-section-title">Paso 2: Identificación del Equipo</h4>
        <div class="form-group">
          <label for="equipoTipo">Tipo de Equipo (*)</label>
          <select id="equipoTipo" name="equipoTipo" required>
            <option value="">Seleccionar tipo...</option>
            <option value="Celular">Celular</option>
            <option value="Tablet">Tablet</option>
            <option value="Notebook">Notebook</option>
            <option value="Smartwatch">Smartwatch</option>
            <option value="Otro">Otro</option>
          </select>
        </div>
        <div class="form-group">
          <label for="equipoColor">Color</label>
          <input type="text" id="equipoColor" name="equipoColor" placeholder="Ej: Negro espacial" />
        </div>
        <div class="form-group">
          <label for="equipoMarca">Marca (*)</label>
          <input type="text" id="equipoMarca" name="equipoMarca" placeholder="Samsung" required />
        </div>
        <div class="form-group">
          <label for="equipoModelo">Modelo (*)</label>
          <input type="text" id="equipoModelo" name="equipoModelo" placeholder="A52" required />
        </div>
        <div class="form-group full-width">
          <label for="equipoSerie">N° de IMEI / Serie</label>
          <input type="text" id="equipoSerie" name="equipoSerie" placeholder="Para celulares marcar *#06#" />
        </div>
      </div>
      
      <div class="form-step" data-step="3">
        <h4 class="form-section-title">Paso 3: Chequeo Básico y Accesorios</h4>
        <div class="diagnostic-grid">
          
          <div class="question-block">
            <h5>Estado de Carga</h5>
            <label class="radio-label"><input type="radio" name="diag_carga" value="Carga Correctamente"><span class="radio-visual"></span><span>Carga Correctamente</span></label>
            <label class="radio-label"><input type="radio" name="diag_carga" value="No Registra Carga"><span class="radio-visual"></span><span>No Registra Carga</span></label>
            <label class="radio-label"><input type="radio" name="diag_carga" value="Sin Verificar" checked><span class="radio-visual"></span><span>Sin Verificar</span></label>
          </div>

          <div class="question-block">
            <h5>Estado de Encendido</h5>
            <label class="radio-label"><input type="radio" name="diag_enciende" value="Enciende Normal"><span class="radio-visual"></span><span>Enciende Normal</span></label>
            <label class="radio-label"><input type="radio" name="diag_enciende" value="No da Señal de Vida"><span class="radio-visual"></span><span>No da Señal de Vida</span></label>
            <label class="radio-label"><input type="radio" name="diag_enciende" value="Sin Verificar" checked><span class="radio-visual"></span><span>Sin Verificar</span></label>
          </div>

          <div class="question-block">
            <h5>Daño Físico Evidente</h5>
            <label class="radio-label"><input type="radio" name="diag_golpeado" value="Con Golpes o Fisuras"><span class="radio-visual"></span><span>Con Golpes o Fisuras</span></label>
            <label class="radio-label"><input type="radio" name="diag_golpeado" value="Sin Daños Aparentes"><span class="radio-visual"></span><span>Sin Daños Aparentes</span></label>
            <label class="radio-label"><input type="radio" name="diag_golpeado" value="Sin Verificar" checked><span class="radio-visual"></span><span>Sin Verificar</span></label>
          </div>

          <div class="question-block">
            <h5>Contacto con Líquidos</h5>
            <label class="radio-label"><input type="radio" name="diag_mojado" value="Con Indicios de Humedad"><span class="radio-visual"></span><span>Con Indicios de Humedad</span></label>
            <label class="radio-label"><input type="radio" name="diag_mojado" value="Sin Indicios de Humedad"><span class="radio-visual"></span><span>Sin Indicios de Humedad</span></label>
            <label class="radio-label"><input type="radio" name="diag_mojado" value="Sin Verificar" checked><span class="radio-visual"></span><span>Sin Verificar</span></label>
          </div>
        </div>

        <div class="form-group full-width" style="margin-top: 1.5rem;">
          <label>Accesorios Entregados</label>
          <div class="accessories-checklist" id="accesoriosChecklist">
            <label class="custom-checkbox-label"><input type="checkbox" name="Tarjeta SIM"><span class="custom-checkbox-visual"><i class="fas fa-check"></i></span><span>Tarjeta SIM</span></label>
            <label class="custom-checkbox-label"><input type="checkbox" name="Tarjeta MicroSD"><span class="custom-checkbox-visual"><i class="fas fa-check"></i></span><span>Tarjeta MicroSD</span></label>
            <label class="custom-checkbox-label"><input type="checkbox" name="Cargador/Cable"><span class="custom-checkbox-visual"><i class="fas fa-check"></i></span><span>Cargador/Cable</span></label>
            <label class="custom-checkbox-label"><input type="checkbox" name="Funda/Carcasa"><span class="custom-checkbox-visual"><i class="fas fa-check"></i></span><span>Funda/Carcasa</span></label>
          </div>
        </div>

        <div class="form-group full-width">
            <label for="estadoCelular">Observaciones Adicionales del Estado (*)</label>
            <textarea id="estadoCelular" name="estadoCelular" placeholder="Pantalla rota, carcasa marcada, etc." rows="2" required></textarea>
        </div>
      </div>

      <div class="form-step" data-step="4">
        <h4 class="form-section-title">Paso 4: Diagnóstico y Falla Reportada</h4>
        <div class="form-group full-width">
            <label for="fallaCategoria">Categoría de la Falla (*)</label>
            <select id="fallaCategoria" name="fallaCategoria" required>
                <option value="">Seleccionar categoría...</option>
                <option value="Pantalla / Táctil">Pantalla / Táctil</option>
                <option value="Batería / Carga">Batería / Carga</option>
                <option value="Cámaras">Cámaras</option>
                <option value="Software / Sistema">Software / Sistema</option>
                <option value="Sonido">Sonido (Micrófono/Altavoz)</option>
                <option value="Señal / Conectividad">Señal / Conectividad (WiFi/Datos)</option>
                <option value="Mojado / Humedad">Mojado / Humedad</option>
                <option value="No enciende">No enciende</option>
                <option value="Otro">Otro</option>
            </select>
        </div>
        <div class="form-group full-width">
          <label for="descripcionFalla">Descripción de la Falla por el Cliente (*)</label>
          <textarea id="descripcionFalla" name="descripcionFalla" placeholder="Problema detallado que reporta el cliente" rows="3" required></textarea>
        </div>
        <div class="form-group full-width">
          <label for="claveContraseña">Clave/Contraseña (Opcional)</label>
          <input type="text" id="claveContraseña" name="claveContraseña" placeholder="Si el cliente la provee para pruebas" />
        </div>
      </div>

      <div class="form-step" data-step="5">
          <h4 class="form-section-title">Paso 5: Acuerdos y Presupuesto</h4>
          <div class="form-group full-width">
              <label for="presupuestoInicial">Presupuesto Inicial Aprobado (Opcional)</label>
              <input type="number" id="presupuestoInicial" name="presupuestoInicial" placeholder="0.00" step="0.01" />
          </div>
          <div class="form-group full-width">
              <label>Términos y Condiciones (*)</label>
              <label class="custom-checkbox-label" for="terminosCondiciones">
                  <input type="checkbox" id="terminosCondiciones" name="terminosCondiciones" required>
                  <span class="custom-checkbox-visual"><i class="fas fa-check"></i></span>
                  <span>Leí y acepto los términos del servicio.</span>
              </label>
              <p class="terms-text">El taller no se responsabiliza por la pérdida de información. Los equipos no retirados después de 90 días se considerarán abandonados.</p>
          </div>
      </div>

      <div class="btn-group">
        <button id="generarRemito" class="submit-btn" type="button">
            <i class="fas fa-plus-circle"></i>
            <span>Registrar Equipo</span>
            <div class="spinner"></div>
        </button>
        <button id="enviarWhatsApp" class="whatsapp-btn" type="button" disabled>
          <i class="fab fa-whatsapp"></i> Enviar Remito
        </button>
      </div>
      <div class="navigation-btns">
        <button type="button" class="btn prev-btn">Anterior</button>
        <button type="button" class="btn next-btn">Siguiente</button>
      </div>
    </form>
  </main>
  
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      tsParticles.load("tsparticles", {
        fpsLimit: 60, particles: { number: { value: 50, }, color: { value: "#ffffff", }, shape: { type: "circle", }, opacity: { value: {min: 0.1, max: 0.5}, }, size: { value: {min: 1, max: 2.5}, }, links: { enable: true, distance: 150, color: "#ffffff", opacity: 0.1, width: 1, }, move: { enable: true, speed: 1, direction: "none", outModes: { default: "out", }, }, }, detectRetina: true,
      });
    });
  </script>
  <script src="scripts/main.js" type="module"></script>
  <script src="scripts/registrar-equipo.js" type="module"></script>
  <script src="scripts/main.js" type="module"></script>
  <script src="scripts/registrar-equipo.js" type="module"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('registroEquipos');
      const nextButton = document.querySelector('.navigation-btns .next-btn');

      form.addEventListener('keydown', (event) => {
        const { key, target } = event;
        const targetTagName = target.tagName.toLowerCase();

        // 1. No interferir con la navegación nativa de los radio buttons
        if (target.type === 'radio' && (key === 'ArrowUp' || key === 'ArrowDown')) {
          return; // Permite que las flechas cambien la opción del radio, como es normal.
        }
        
        // 2. No interferir al escribir en un textarea (salvo que se presione Enter)
        if (targetTagName === 'textarea' && key !== 'Enter') {
            return;
        }

        // 3. Lógica para mover el foco con Enter y Flechas
        if (key === 'Enter' || key === 'ArrowDown' || key === 'ArrowUp') {
          // Prevenimos la acción por defecto (ej: enviar formulario con Enter)
          event.preventDefault();

          const activeStep = form.querySelector('.form-step.active');
          if (!activeStep) return;

          // Obtenemos todos los campos por los que se puede navegar en el paso actual
          const focusableElements = Array.from(
            activeStep.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea')
          ).filter(el => !el.disabled);

          const currentIndex = focusableElements.indexOf(target);

          if (currentIndex === -1) return; // No hacer nada si el campo no es navegable

          let nextIndex;
          if (key === 'ArrowUp') {
            nextIndex = currentIndex - 1; // Mover hacia arriba
          } else {
            nextIndex = currentIndex + 1; // Mover hacia abajo o con Enter
          }

          // Si se presiona Enter en el último campo del paso, pasar al siguiente
          if (key === 'Enter' && nextIndex >= focusableElements.length) {
            if (nextButton && !nextButton.disabled) {
              nextButton.click();
            }
            return;
          }

          // Mover el foco al siguiente o anterior campo si existe
          const nextElement = focusableElements[nextIndex];
          if (nextElement) {
            nextElement.focus();
            // Si el campo es de texto o número, seleccionamos su contenido para editarlo rápido
            if (nextElement.type === 'text' || nextElement.type === 'number' || nextElement.type === 'tel' || nextElement.type === 'email') {
              nextElement.select();
            }
          }
        }
      });
    });
  </script>
  </body>
</html>
</body>
</html>